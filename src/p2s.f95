MODULE p2s
  USE precisao
  USE leitura
  IMPLICIT NONE
!------------------------------------------------------------------------------------------------------------------        
CONTAINS
!------------------------------------------------------------------------------------------------------------------
FUNCTION f1(u)
    IMPLICIT NONE
    REAL(pr),DIMENSION(:),INTENT(IN)     :: u
    REAL(pr),DIMENSION(size(u))         :: f1
!------------------------------------------------------------------------------------------------------------------
!#  u(1) = o1
!#  u(2) = o2
!#  u(3) = w1
!#  u(4) = w2    
!------------------------------------------------------------------------------------------------------------------
! # Equações diferenciais   
    f1(1) = u(3)                                                                                        ! Derivada primeira temporal de theta1 
    f1(2) = u(4)                                                                                        ! Derivada primeira temporal de theta2
    f1(3) = -(m2/(m1+m2))*(l2/l1)*(f1(4)*cos(u(1)-u(2))+f1(2)*f1(2)*sin(u(1)-u(2)))-(g/l1)*sin(u(1))    ! Derivada segunda temporal de theta1
    f1(4) = -(l1/l2)*(f1(3)*cos(u(1)-u(2))-f1(1)*f1(1)*sin(u(1)-u(2)))-(g/l2)*sin(u(2))                 ! Derivada segunda temporal de theta2
!------------------------------------------------------------------------------------------------------------------
  END FUNCTION f1
!------------------------------------------------------------------------------------------------------------------
FUNCTION f2(u)
    IMPLICIT NONE
    REAL(pr),DIMENSION(:),INTENT(IN)     :: u
    REAL(pr),DIMENSION(size(u))         :: f2
    REAL(pr)                             :: a2 ! Variáveis auxiliares
!------------------------------------------------------------------------------------------------------------------
!#  u(1) = o1
!#  u(2) = o2
!#  u(3) = r1
!#  u(4) = w1
!#  u(5) = w2
!#  u(6) = v1
!------------------------------------------------------------------------------------------------------------------
! # Equações diferenciais de segunda ordem
    a2  = m2/(m1+m2)  
    f2(1) = u(4)                                                                                            ! Derivada primeira temporal de theta1 
    f2(2) = u(5)                                                                                            ! Derivada primeira temporal de theta2
    f2(3) = u(6)                                                                                            ! Derivada primeira temporal de l1
!
    f2(4) = -(2.0/(l10+u(3)))*u(6)*u(4)  -a2*(l2/(l10+u(3)))*(f2(5)*cos(u(1)& 
            -u(2))+f2(2)*f2(2)*sin(u(1)-u(2)))-(g/(l10+u(3)))*sin(u(1))                                                               ! Derivada segunda temporal de theta1
!
    f2(5) = -(1.0/l2)*f2(6)*sin(u(1)-u(2))-(2.0/l2)*u(6)*u(4)*cos(u(1)-u(2))&
    -(l10+u(3)/l2)*(f2(4)*cos(u(1)-u(2))-u(4)*u(4)*sin(u(1)-u(2)))-(g/l2)*sin(u(2))
!
    f2(6) = -a2*l2*(f2(5)*sin(u(1)-u(2))-u(5)*u(5)*cos(u(1)-u(2))) & 
            +(l10+u(3))*u(4)*u(4)+g*cos(u(1))-(k1/(m1+m2))*(l10+u(3)-l1)
!------------------------------------------------------------------------------------------------------------------
  END FUNCTION f2
!------------------------------------------------------------------------------------------------------------------
FUNCTION f3(u3)
    IMPLICIT NONE
    REAL(pr),DIMENSION(:),INTENT(IN)     :: u3
    REAL(pr),DIMENSION(size(u3))         :: f3
    REAL(pr)                             :: a3
!------------------------------------------------------------------------------------------------------------------
!#  u3(1) = o1
!#  u3(2) = o2
!#  u3(3) = r2
!#  u3(4) = w1 
!#  u3(5) = w1 
!#  u3(6) = v2 
!------------------------------------------------------------------------------------------------------------------
! # Equações diferenciais   
a3  = m2/(m2+m2)
    f3(1) = u3(4)                                                                                               ! Derivada primeira temporal de theta1 
    f3(2) = u3(5)                                                                                               ! Derivada primeira temporal de theta2
    f3(3) = u3(6)                                                                                               ! Derivada primeira temporal de l2
!    
    f3(4) = -a3*((l20+u3(3))/l1)*(f3(5)*cos(u3(1)-u3(2))+f3(2)*f3(2)*sin&
    (u3(1)-u3(2)))+a3*(1/l1)*(f3(6)*sin(u3(1)-u3(2))+f3(3)*f3(3)*cos(u3(1)-u3(2)))-(g/l1)*sin(u3(1))
!
    f3(5) = (l1/(l20+u3(3)))*(f3(4)*cos(u3(1)-u3(2))-f3(1)*f3(1)*sin(u3(1)-u3(2)))-(g/(l20+u3(2)))*sin(u3(1)-u3(2))
!
    f3(6) = l1*(f3(4)*sin(u3(1)-u3(2))-f3(1)*f3(1)*cos(u3(1)-u3(2)))+(l20+u3(4))*f3(2)*f3(2)-g*cos(u3(2))-(k2/m2)*(l20+u3(4)-l2)
!------------------------------------------------------------------------------------------------------------------
  END FUNCTION f3
!------------------------------------------------------------------------------------------------------------------
FUNCTION f4(u4)
    IMPLICIT NONE
    REAL(pr),DIMENSION(:),INTENT(IN)     :: u4
    REAL(pr),DIMENSION(size(u4))         :: f4
!------------------------------------------------------------------------------------------------------------------
!#  u4(1) = o1
!#  u4(2) = o2
!#  u4(3) = r1
!#  u4(4) = r2 
!#  u4(5) = w1
!#  u4(6) = w2
!#  u4(7) = v1
!#  u4(8) = v2 
!------------------------------------------------------------------------------------------------------------------
! # Equações diferenciais    
    f4(1) = u4(5)                                                                                            ! Derivada primeira temporal de theta1 
    f4(2) = u4(6)                                                                                            ! Derivada primeira temporal de theta2
    f4(3) = u4(7)                                                                                            ! Derivada primeira temporal de l1
    f4(4) = u4(8)                                                                                            ! Derivada primeira temporal de l2
!    
    f4(5) = -(m2/(m1+m2))*(l20+u4(4)/(l10+u4(3)))*f4(6)*cos(u4(1)&
    -u4(2))-(m2/(m1+m2))*(1/(l10+u4(3)))*(f4(8)*sin(u4(1)-u4(2))+&
    f4(4)*f4(2)*cos(u4(1)-u4(2))+f4(1)*f4(3)*cos(u4(1)-u4(2)))+2*&
    (m2/(m1+m2))*(1/((l10+u4(3))*(l10+u4(3))))*f4(3)*f4(4)*cos(u4(1))*&
    cos(u4(2))+(g/(l10+u4(3)))*sin(u4(1))     ! Derivada segunda temporal de theta1
!    
    f4(6) = -(((l10+u4(3))/(l20+u4(4)))*(f4(1)*cos(u4(1)-u4(2))&
    -f4(1)*f4(1)*sin(u4(1)-u4(2)))-(1/(l20+u4(4)))*f4(7)*sin(u4(1)&
    -u4(2))-(2/(l20+u4(4)))*f4(3)*f4(1)*cos(u4(1)-u4(2))-(2/(l20+&
    u4(4))*(l20+u4(4)))*f4(3)*f4(4)*cos(u4(1)-u4(2))*sin(u4(1)-u4(2))-(g/(l20+u4(4)))&
    *sin(u4(2)))         ! Derivada segunda temporal de theta2
!    
    f4(7) =  u4(4)    ! Será escrito aqui o resto do sistema de equações diferenciais 
!    
    f4(8) = u4(4)     ! Será escrito aqui o resto do sistema de equações diferenciais
!------------------------------------------------------------------------------------------------------------------
  END FUNCTION f4
!------------------------------------------------------------------------------------------------------------------
END MODULE p2s
